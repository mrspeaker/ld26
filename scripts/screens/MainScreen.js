(function (Ω) {

	"use strict";

	var MainScreen = Ω.Screen.extend({

		sheet: new Ω.SpriteSheet("res/tiles.png", 32),

		init: function () {

			this.map = new Ω.Map(this.sheet, [
				[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
				[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
				[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
				[0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0],
				[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
				[0,0,0,0,0,0,0,2,0,0,0,0,3,3,0,0,0,0,0,0,0,0,2,0,0,0,0,3,3,0],
				[1,0,2,0,0,0,2,3,2,0,0,0,0,0,0,0,0,2,0,0,0,2,3,2,0,0,0,0,0,0],
				[1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1],
				[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
				[0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0],
				[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
				[0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0],
				[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],
				[0,0,0,0,0,0,0,2,0,0,0,0,3,3,0,0,0,0,0,0,0,0,2,0,0,0,0,3,3,0],
				[1,0,2,0,0,0,2,3,2,0,0,0,0,0,0,1,0,2,0,0,0,2,3,2,0,0,0,0,0,0],
				[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
			]);

			this.player = new Player(4, 7, this);
			this.player.setMap(this.map);

			this.camera = new Ω.TrackingCamera(this.player, 0, 0, Ω.env.w, Ω.env.h);

			paintLayers.reset();
			paintLayers.add("stains", "#container");

		},

		tick: function () {

			this.player.tick(this.map);
			this.camera.tick();

		},

		render: function (gfx) {

			var c = gfx.ctx;

			c.fillStyle = "hsl(120, 10%, 95%)";
			c.fillRect(0, 0, gfx.w, gfx.h);

			this.camera.render(gfx, [this.player, this.map]);

		}

	});

	window.MainScreen = MainScreen;

}(Ω));
